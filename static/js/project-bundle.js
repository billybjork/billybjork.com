// Auto-generated by esbuild - do not edit directly

"use strict";(()=>{var ne="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css",ie="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js",re="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js";function q(e,o){let t=document.createElement("script");t.type="text/javascript",t.onload=function(){o&&o()},t.src=e,document.head.appendChild(t)}function se(e,o){let t=document.createElement("link");t.rel="stylesheet",t.href=e,t.onload=function(){o&&o()},document.head.appendChild(t)}function ae(e){se(ne,function(){q(ie,function(){q(re,function(){e&&e()})})})}function x(e){e.querySelector("pre code")&&(typeof window.Prism>"u"?ae(function(){window.Prism?.highlightAllUnder(e)}):window.Prism.highlightAllUnder(e))}typeof window<"u"&&(window.checkAndHighlightCode=x);var g=null;function U(e){e.querySelector("pre code")&&x(e)}function ce(){let e=new URLSearchParams(window.location.search);return e.has("show_drafts")?e.get("show_drafts")==="true":sessionStorage.getItem("bb_show_drafts")==="true"}function S(e,o={}){let t=new URL(e,window.location.origin);return Object.entries(o).forEach(([n,i])=>{i!=null&&t.searchParams.set(n,String(i))}),ce()&&t.searchParams.set("show_drafts","true"),t.toString()}function u(e,o={}){document.body.dispatchEvent(new CustomEvent(e,{bubbles:!0,detail:o}))}function F(e,o=!1){let t=document.createElement("div");t.className=`copy-notification${o?" error":""}`,t.textContent=e,document.body.appendChild(t),setTimeout(()=>{t.parentNode&&document.body.removeChild(t)},4e3)}async function $(e,o){let t=await fetch(e,{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"text/html"},signal:o});if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);return await t.text()}async function H(e,o={}){let{pushUrl:t=!0,smoothScroll:n=!0}=o,i=document.querySelector(`.project-item[data-slug="${e}"]`);if(!i){console.error(`Project item not found for slug: ${e}`);return}if(i.classList.contains("active"))return;let r=document.getElementById(`details-${e}`);if(!r){console.error(`Details container not found for slug: ${e}`);return}g&&g.abort(),g=new AbortController,A(),u("project:beforeLoad",{element:r,slug:e,isOpen:!0});try{let s=S(`/${e}`),l=await $(s,g.signal);if(u("project:beforeSwap",{element:r,slug:e,isOpen:!0}),r.innerHTML=l,i.classList.add("active"),t){let a=S(`/${e}`);history.pushState({slug:e,isOpen:!0},"",a)}u("project:afterSwap",{element:r,slug:e,isOpen:!0,smoothScroll:n}),U(r),u("project:loaded",{element:r,slug:e,isOpen:!0})}catch(s){if(s instanceof Error&&s.name==="AbortError")return;console.error("Failed to load project:",s),u("project:error",{element:r,slug:e,isOpen:!1,error:s instanceof Error?s:new Error(String(s))}),F("Failed to load content. Please try again.",!0)}finally{g=null}}async function k(e,o={}){let{pushUrl:t=!0}=o,n=document.querySelector(`.project-item[data-slug="${e}"]`);if(!n)return;let i=document.getElementById(`details-${e}`);if(i){if(u("project:beforeSwap",{element:i,slug:e,isOpen:!1}),i.innerHTML="",n.classList.remove("active"),t){let r=S("/");history.pushState({slug:null,isOpen:!1},"",r)}u("project:afterSwap",{element:i,slug:e,isOpen:!1})}}function A(){document.querySelectorAll(".project-item.active").forEach(o=>{let t=o.dataset.slug;if(!t)return;let n=document.getElementById(`details-${t}`);u("project:beforeSwap",{element:n,slug:t,isOpen:!1}),n&&(n.innerHTML=""),o.classList.remove("active"),u("project:afterSwap",{element:n,slug:t,isOpen:!1})})}async function z(e){let o=parseInt(e.dataset.page??"",10);if(!(!o||e.dataset.loading==="true")){e.dataset.loading="true";try{let t=S("/",{page:o}),n=await $(t);e.insertAdjacentHTML("beforebegin",n),e.remove(),u("projects:loaded",{page:o})}catch(t){console.error("Failed to load more projects:",t),e.dataset.loading="false",F("Failed to load more projects.",!0)}}}var b=null;function le(){b&&b.disconnect(),b=new IntersectionObserver(e=>{e.forEach(o=>{if(o.isIntersecting){let t=o.target;t.dataset.page&&z(t)}})},{rootMargin:"100px",threshold:0}),N()}function N(){document.querySelectorAll('[id^="infinite-scroll-sentinel-"]').forEach(o=>{o.dataset.page&&b&&b.observe(o)})}function de(e){let o=e.state;if(o&&o.slug&&o.isOpen)H(o.slug,{pushUrl:!1});else{let t=window.location.pathname;t==="/"?A():t!=="/me"&&window.location.reload()}}function ue(e){let o=e.target,t=o.closest(".project-header");if(t){let r=t.closest(".project-item");if(r){let s=r.dataset.slug;if(s){e.preventDefault(),H(s);return}}}let n=o.closest(".thumbnail");if(n){let r=n.closest(".project-item");if(r){let s=r.dataset.slug;if(s){e.preventDefault(),H(s);return}}}let i=o.closest(".close-project");if(i&&!(document.body.dataset.isolationMode==="true")){let s=i.closest(".project-item");if(s){let l=s.dataset.slug;if(l){e.preventDefault(),k(l);return}}}}function R(){if(document.body.addEventListener("click",ue),window.addEventListener("popstate",de),le(),document.body.addEventListener("projects:loaded",()=>{N()}),!history.state){let e=window.location.pathname;if(e!=="/"&&e!=="/me"){let o=e.slice(1);history.replaceState({slug:o,isOpen:!0},"")}else history.replaceState({slug:null,isOpen:!1},"")}U(document.body)}function fe(){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",R):R()}var _={openProject:H,closeProject:k,closeAllProjects:A,loadMoreProjects:z,dispatchEvent:u,init:fe};typeof window<"u"&&(window.ProjectLoader=_);var V=_;function P(e){e&&(e.style.backgroundPosition="0 0")}function X(e){let i=e.getBoundingClientRect().top+window.pageYOffset-40;window.scrollTo({top:i,behavior:"smooth"})}function E(e,o=!1){let t=document.createElement("div");t.className=`copy-notification${o?" error":""}`,t.textContent=e,document.body.appendChild(t),setTimeout(()=>{t.parentNode&&document.body.removeChild(t)},4e3)}function D(e,o="URL copied to clipboard!"){navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(e).then(()=>{E(o)}).catch(t=>{console.error("Failed to copy using Clipboard API: ",t),E("Failed to copy the URL.",!0)}):(console.warn("Clipboard API not supported in this browser."),E("Copy to clipboard not supported in this browser.",!0))}function G(e=document){let o=e.querySelectorAll("a[href]"),t=window.location.host;o.forEach(n=>{let i=n.getAttribute("href");if(i&&!(i.startsWith("#")||i.startsWith("/")||i.startsWith("../")||i.startsWith("mailto:")||i.startsWith("tel:")))try{new URL(i,window.location.origin).host!==t&&(n.setAttribute("target","_blank"),n.setAttribute("rel","noopener noreferrer"))}catch{}})}function me(e,o){e.forEach(t=>{if(t.isIntersecting){let n=t.target;n.classList.add("fade-in"),o.unobserve(n)}})}var pe=new IntersectionObserver(me,{root:null,rootMargin:"0px",threshold:.1});function K(e){e.forEach(o=>{!o.classList.contains("fade-in")&&!o.classList.contains("no-fade")&&pe.observe(o)})}function he(){let e=document.querySelectorAll(".project-item");K(e)}function ve(e,o){e.forEach(t=>{if(t.isIntersecting){let n=t.target,i=n.getAttribute("data-bg");if(i){let r=new Image;r.onload=()=>{n.style.backgroundImage=`url('${i}')`,n.removeAttribute("data-bg"),requestAnimationFrame(()=>{n.classList.remove("lazy-thumbnail")})},r.src=i}o.unobserve(n)}})}var Le=new IntersectionObserver(ve,{rootMargin:"0px 0px 50px 0px",threshold:.1});function T(e=document){e.querySelectorAll(".lazy-thumbnail").forEach(t=>{t.getAttribute("data-bg")&&Le.observe(t)})}var ge=document.body.dataset.hlsJsSrc||"https://cdn.jsdelivr.net/npm/hls.js@1.5.12",j=null;function be(){return window.Hls?Promise.resolve():j||(j=new Promise((e,o)=>{let t=document.createElement("script");t.src=ge,t.async=!0,t.onload=()=>e(),t.onerror=()=>o(new Error("Failed to load HLS.js")),document.head.appendChild(t)}),j)}function w(e,o=!1){return console.log("[HLS] setupHLSPlayer called",{autoplay:o}),new Promise((t,n)=>{let i=e.dataset.hlsUrl;if(console.log("[HLS] Stream URL:",i),!i){console.error("No HLS URL provided for video element"),n("No HLS URL provided");return}e.classList.add("hls-video");let r=()=>{o&&!document.body.classList.contains("editing")&&e.play().catch(a=>{a.name!=="AbortError"&&console.error("Autoplay failed:",a)}),t()},s=e.canPlayType("application/vnd.apple.mpegurl");console.log("[HLS] Native HLS support:",s?"yes":"no"),console.log("[HLS] HLS.js loaded:",!!window.Hls),console.log("[HLS] HLS.js supported:",window.Hls?Hls.isSupported():"n/a");let l=()=>{if(!window.Hls||!Hls.isSupported()){if(s){e.src=i,e.addEventListener("loadedmetadata",r,{once:!0});return}console.error("HLS is not supported in this browser"),n("HLS is not supported");return}e.hlsInstance&&(console.warn("HLS instance already exists for this video element. Destroying existing instance."),e.hlsInstance.destroy());let a=new Hls({abrEwmaDefaultEstimate:5e6,capLevelToPlayerSize:!0});e.hlsInstance=a,a.loadSource(i),a.attachMedia(e),a.on(Hls.Events.MEDIA_ATTACHED,()=>{a.on(Hls.Events.MANIFEST_PARSED,()=>{console.log("[HLS] Available quality levels:"),a.levels.forEach((f,d)=>{console.log(`  [${d}] ${f.height}p @ ${(f.bitrate/1e6).toFixed(1)} Mbps`)}),console.log(`[HLS] Starting level: ${a.startLevel} (auto: ${a.autoLevelEnabled})`),console.log(`[HLS] Current level: ${a.currentLevel}, Next level: ${a.nextLevel}`),r()})}),a.on(Hls.Events.LEVEL_SWITCHED,(f,d)=>{let m=d,I=a.levels[m.level];I&&console.log(`[HLS] Switched to level ${m.level}: ${I.height}p @ ${(I.bitrate/1e6).toFixed(1)} Mbps`)}),a.on(Hls.Events.ERROR,(f,d)=>{let m=d;if(m.fatal)switch(m.type){case Hls.ErrorTypes.NETWORK_ERROR:console.error("Fatal network error encountered, trying to recover"),a.startLoad();break;case Hls.ErrorTypes.MEDIA_ERROR:console.error("Fatal media error encountered, trying to recover"),a.recoverMediaError();break;default:console.error("Fatal error encountered, destroying HLS instance:",d),a.destroy(),e.hlsInstance=null,n(d);break}else m.details==="bufferAppendError"?(console.warn("HLS.js bufferAppendError encountered and ignored:",d),a.recoverMediaError()):console.warn("HLS.js non-fatal error:",d)})};if(window.Hls&&Hls.isSupported()){console.log("[HLS] Using HLS.js (already loaded)"),l();return}console.log("[HLS] Loading HLS.js script..."),be().then(()=>{Hls.isSupported()?(console.log("[HLS] HLS.js loaded and supported, using HLS.js"),l()):s?(console.log("[HLS] HLS.js not supported, falling back to native"),e.src=i,e.addEventListener("loadedmetadata",r,{once:!0})):(console.error("HLS is not supported in this browser"),n("HLS is not supported"))}).catch(a=>{if(s){console.log("[HLS] HLS.js failed to load, falling back to native"),e.src=i,e.addEventListener("loadedmetadata",r,{once:!0});return}console.error("Failed to load HLS.js:",a),n(a)})})}function p(e){if(e.hlsInstance&&(e.hlsInstance.destroy(),e.hlsInstance=null),e.src&&e.src.startsWith("blob:")){let o=e.src;URL.revokeObjectURL(o),e.src=""}}async function y(e,o=!0){try{let t=e.querySelector("video.project-video, video.lazy-video"),n=e.querySelector(".thumbnail");if(e.classList.contains("active")){t&&await w(t,!0);let i=e.querySelector(".project-header");i&&o&&X(i)}else t&&(t.pause(),p(t)),n&&P(n);typeof h=="function"&&h()}catch(t){console.error("Error in handleProjectContent:",t)}}function Q(){document.querySelectorAll(".project-item.active").forEach(o=>{o.classList.remove("active");let t=o.querySelector("video.project-video");t&&(t.pause(),p(t));let n=o.querySelector(".project-details");n&&(n.innerHTML="");let i=o.querySelector(".thumbnail");i&&P(i)})}var v=0;function h(){let e=document.querySelectorAll(".thumbnail");e.length&&e.forEach(o=>{let t=parseInt(o.dataset.frames??"0",10),n=parseInt(o.dataset.frameWidth??"0",10),i=parseInt(o.dataset.frameHeight??"0",10),r=parseInt(o.dataset.columns??"1",10),s=Math.ceil(t/r),l=n*r,a=i*s;o.style.backgroundSize=`${l}px ${a}px`;let f=Math.floor(v)%t;f<0&&(f+=t);let d=f%r*n,m=Math.floor(f/r)*i;o.style.backgroundPosition=`-${d}px -${m}px`})}var W=window.pageYOffset||document.documentElement.scrollTop,B=Date.now(),c=0,O=Date.now(),L=null;function Z(){L!==null||document.hidden||(O=Date.now(),L=requestAnimationFrame(ee))}function C(){L!==null&&(cancelAnimationFrame(L),L=null)}function Ee(){let e=window.pageYOffset||document.documentElement.scrollTop,o=Date.now(),t=(o-B)/1e3;t>0&&(c=(e-W)/t/3,c=Math.max(-30,Math.min(30,c))),W=e,B=o,Math.abs(c)>.01&&Z()}function ee(){if(document.hidden){C();return}let e=Date.now(),o=(e-O)/1e3;O=e;let t=15,n=Math.abs(c)*.1,i=t+n;c>0?c=Math.max(0,c-i*o):c<0&&(c=Math.min(0,c+i*o)),v+=c*o,v>1e6&&(v-=1e6),v<-1e6&&(v+=1e6),h(),Math.abs(c)>.01?L=requestAnimationFrame(ee):(c=0,C())}function we(){window.location.pathname==="/"||document.querySelectorAll(".project-item").forEach(t=>{t.classList.add("no-fade")}),T(),h(),window.addEventListener("scroll",Ee)}function te(e=document){let o=e.querySelectorAll("video.lazy-video, video.project-video");if("IntersectionObserver"in window){let t=new IntersectionObserver((n,i)=>{n.forEach(r=>{if(r.isIntersecting){let s=r.target;w(s,!1).catch(l=>{console.error("Failed to initialize HLS player for video:",l)}),i.unobserve(s),s.dataset.loaded="true"}})},{rootMargin:"0px 0px 200px 0px",threshold:.25});o.forEach(n=>{n.dataset.loaded||t.observe(n)})}else o.forEach(t=>{w(t,!1).catch(n=>{console.error("Failed to initialize HLS player for video:",n)}),t.dataset.loaded="true"})}function ye(){te(),T(),Se()}function Se(){let e=document.querySelector(".project-item.active");e&&(document.readyState==="complete"?y(e,!1):window.addEventListener("load",()=>{y(e,!1)}))}function M(){document.querySelectorAll("video.hls-video").forEach(t=>{p(t)}),document.querySelectorAll("video").forEach(t=>{t.hlsInstance&&p(t)})}function He(){M()}function je(e){let{element:o,isOpen:t,smoothScroll:n=!0}=e.detail;if(!o)return;let i=o.closest(".project-item");if(i){if(t){let r=o.querySelector("video.project-video");r&&w(r,!0).catch(l=>{console.error("Failed to initialize HLS player:",l)});let s=i.querySelector(".project-header");s&&n&&X(s)}else{let r=i.querySelector("video.project-video");r&&(r.pause(),p(r));let s=i.querySelector(".thumbnail");s&&P(s)}T(o),te(o),h(),G(o)}}function Pe(){let e=document.querySelectorAll(".project-item:not(.fade-in):not(.no-fade)");K(e),T(),h()}function Te(e){let{element:o}=e.detail,t=o?.closest(".project-item");t&&y(t)}function Y(e){let o=e.closest(".project-item");if(!o)return;if(document.body.dataset.isolationMode==="true")o.classList.add("fade-out"),o.addEventListener("animationend",function n(){o.removeEventListener("animationend",n);let i=new URL("/",window.location.origin);(new URLSearchParams(window.location.search).get("show_drafts")==="true"||sessionStorage.getItem("bb_show_drafts")==="true")&&i.searchParams.set("show_drafts","true"),window.location.href=i.toString()});else{o.classList.remove("active");let n=o.querySelector("video.project-video");n&&(n.pause(),p(n));let i=o.querySelector(".thumbnail");i&&P(i);let r=o.querySelector(".project-details");r&&(r.innerHTML="")}}function Me(){document.body.addEventListener("project:afterSwap",je),document.body.addEventListener("project:beforeSwap",He),document.body.addEventListener("project:loaded",Te),document.body.addEventListener("projects:loaded",Pe),document.body.addEventListener("project:error",()=>{E("Failed to load content. Please try again.",!0)}),document.body.addEventListener("click",e=>{let t=e.target.closest(".copy-text-link");if(t){e.preventDefault();let n=t.getAttribute("data-copy-text"),i=t.getAttribute("data-notification-message")||"URL copied to clipboard!";n?D(n,i):(console.warn("No copy text provided for copying."),E("No content available to copy.",!0))}}),document.body.addEventListener("click",function(e){let o=e.target.closest(".close-project");o&&document.body.dataset.isolationMode==="true"&&(e.preventDefault(),Y(o))}),document.body.addEventListener("click",function(e){let o=e.target.closest(".project-content img");if(!o)return;let t=document.createElement("div");t.className="image-lightbox";let n=document.createElement("button");n.className="image-lightbox-close",n.innerHTML="&times;";let i=document.createElement("img");i.src=o.src,i.alt=o.alt||"",t.appendChild(n),t.appendChild(i),document.body.appendChild(t),requestAnimationFrame(()=>t.classList.add("visible"));let r=()=>{t.classList.remove("visible"),t.addEventListener("transitionend",()=>t.remove(),{once:!0})};n.addEventListener("click",r),t.addEventListener("click",function(s){s.target===t&&r()})}),document.addEventListener("keydown",function(e){if(e.key==="Escape"){if(document.body.classList.contains("editing"))return;let o=document.querySelector(".image-lightbox");if(o){o.classList.remove("visible"),o.addEventListener("transitionend",()=>o.remove(),{once:!0});return}let t=document.querySelector(".project-item.active");if(t){let n=t.querySelector(".close-project");if(n)if(document.body.dataset.isolationMode==="true")Y(n);else{let r=t.dataset.slug;r&&window.ProjectLoader&&window.ProjectLoader.closeProject(r)}}}}),document.addEventListener("visibilitychange",()=>{document.hidden?C():Math.abs(c)>.01&&Z()})}function J(){if(window.location.hash){let e=document.getElementById(window.location.hash.slice(1));e&&e.scrollIntoView({behavior:"smooth"})}}function Ie(){we(),ye(),he(),G(),window.addEventListener("beforeunload",M)}function xe(){Ie(),Me(),window.addEventListener("load",J),window.addEventListener("hashchange",J)}typeof window<"u"&&(window.copyToClipboard=D,window.handleProjectContent=y,window.closeAllOpenProjects=Q,window.cleanupActiveHLSPlayers=M);var Ae={init:xe,handleProjectContent:y,closeAllOpenProjects:Q,cleanupActiveHLSPlayers:M,copyToClipboard:D,updateThumbnails:h,setupHLSPlayer:w,destroyHLSPlayer:p},oe=Ae;oe.init();V.init();})();
//# sourceMappingURL=project-bundle.js.map
