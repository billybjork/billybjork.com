// Auto-generated by esbuild - do not edit directly

"use strict";(()=>{var _e="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css",qe="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js",ze="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js";function Q(e,t){let n=document.createElement("script");n.type="text/javascript",n.onload=function(){t&&t()},n.src=e,document.head.appendChild(n)}function Be(e,t){let n=document.createElement("link");n.rel="stylesheet",n.href=e,n.onload=function(){t&&t()},document.head.appendChild(n)}function Ue(e){Be(_e,function(){Q(qe,function(){Q(ze,function(){e&&e()})})})}function ee(e){e.querySelector("pre code")&&(typeof window.Prism>"u"?Ue(function(){window.Prism?.highlightAllUnder(e)}):window.Prism.highlightAllUnder(e))}var We="https://cdn.jsdelivr.net/npm/hls.js@1.5.12",Ke="application/vnd.apple.mpegurl",te={abrEwmaDefaultEstimate:5e6,capLevelToPlayerSize:!0},A=null;function N(){return window.Hls?Promise.resolve():A||(A=new Promise((e,t)=>{let n=document.createElement("script");n.src=document.body.dataset.hlsJsSrc||We,n.async=!0,n.onload=()=>e(),n.onerror=()=>t(new Error("Failed to load HLS.js")),document.head.appendChild(n)}),A)}function ne(e){return!!e.canPlayType(Ke)}function F(e){e.hlsInstance&&(e.hlsInstance.destroy(),e.hlsInstance=null)}function L(e,t=!1){let n=document.createElement("div");n.className=`copy-notification${t?" error":""}`,n.textContent=e,document.body.appendChild(n),setTimeout(()=>{n.parentNode&&document.body.removeChild(n)},4e3)}function V(e,t="URL copied to clipboard!"){navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(e).then(()=>{L(t)}).catch(n=>{console.error("Failed to copy using Clipboard API: ",n),L("Failed to copy the URL.",!0)}):(console.warn("Clipboard API not supported in this browser."),L("Copy to clipboard not supported in this browser.",!0))}function $(e){let t=e.startsWith("#")?e.slice(1):e;if(!t)return null;let n=t;try{n=decodeURIComponent(t)}catch{n=t}let o=document.getElementById(n)||document.getElementById(t);if(o)return o;let i=n.replace(/_\d+$/,"");if(i&&i!==n){let s=document.getElementById(i);if(s)return s}let r=t.replace(/_\d+$/,"");if(r&&r!==t){let s=document.getElementById(r);if(s)return s}return null}function oe(e="auto"){let t=$(window.location.hash);t&&t.scrollIntoView({behavior:e,block:"start"})}var S="data-scroll-lock-count",q="data-scroll-lock-y";function I(){let e=document.body,t=Number(e.getAttribute(S)||"0");if(t===0){let n=window.scrollY||window.pageYOffset||0;e.setAttribute(q,String(n)),e.classList.add("modal-open"),e.style.position="fixed",e.style.top=`-${n}px`,e.style.left="0",e.style.right="0",e.style.width="100%",e.style.overflow="hidden"}e.setAttribute(S,String(t+1))}function _(){let e=document.body,t=Number(e.getAttribute(S)||"0");if(t<=0){e.classList.remove("modal-open");return}if(t>1){e.setAttribute(S,String(t-1));return}let n=Number(e.getAttribute(q)||"0");e.removeAttribute(S),e.removeAttribute(q),e.classList.remove("modal-open"),e.style.position="",e.style.top="",e.style.left="",e.style.right="",e.style.width="",e.style.overflow="";let o=document.documentElement,i=o.style.scrollBehavior;o.style.scrollBehavior="auto",window.scrollTo({top:n,left:0,behavior:"auto"}),requestAnimationFrame(()=>{i?o.style.scrollBehavior=i:o.style.removeProperty("scroll-behavior")})}var ie="lightbox-trigger-video";function re(e){if(e.dataset.closing==="true")return;e.dataset.closing="true";let t=e.querySelector("video");t&&t.pause(),_(),e.classList.remove("visible"),e.addEventListener("transitionend",()=>e.remove(),{once:!0})}function P(){let e=document.querySelector(".image-lightbox");return e?(re(e),!0):!1}function Ye(e){return e.controls||e.hasAttribute("controls")}function z(e){return!e.closest(".project-content")||e.closest(".video-container")||e.dataset.lightbox==="off"||Ye(e)?!1:e.loop||e.autoplay||e.hasAttribute("loop")||e.hasAttribute("autoplay")}function B(e=document){e.querySelectorAll(".project-content video").forEach(n=>{n.classList.toggle(ie,z(n))})}function se(){let e=document.createElement("div");e.className="image-lightbox";let t=document.createElement("button");return t.className="image-lightbox-close",t.setAttribute("type","button"),t.setAttribute("aria-label","Close media"),t.innerHTML="&times;",e.appendChild(t),{overlay:e,closeButton:t}}function ae(e,t){let n=()=>re(e);t.addEventListener("click",n),e.addEventListener("click",o=>{o.target===e&&n()})}function le(e){P();let{overlay:t,closeButton:n}=se(),o=document.createElement("img");o.src=e.currentSrc||e.src,o.alt=e.alt||"",t.appendChild(o),document.body.appendChild(t),I(),requestAnimationFrame(()=>t.classList.add("visible")),ae(t,n)}function ce(e){P();let{overlay:t,closeButton:n}=se(),o=e.cloneNode(!0);o.removeAttribute("id"),o.classList.remove("lazy-video","lazy-inline-video","hls-video",ie);let i=e.autoplay||e.hasAttribute("autoplay")||e.loop||e.hasAttribute("loop"),r=e.loop||e.hasAttribute("loop");o.controls=!1,o.removeAttribute("controls"),o.autoplay=i,o.loop=r,o.muted=!0,o.defaultMuted=!0,o.playsInline=!0,o.preload="auto",i?o.setAttribute("autoplay",""):o.removeAttribute("autoplay"),r?o.setAttribute("loop",""):o.removeAttribute("loop"),o.setAttribute("muted",""),o.setAttribute("playsinline",""),e.currentSrc&&(o.src=e.currentSrc),t.appendChild(o),document.body.appendChild(t),I(),requestAnimationFrame(()=>{t.classList.add("visible"),i&&o.play().catch(()=>{})}),ae(t,n)}function k(e){e&&(e.style.backgroundPosition="0 0")}function fe(e){let i=e.getBoundingClientRect().top+window.pageYOffset-40;window.scrollTo({top:i,behavior:"smooth"})}function me(e=document){let t=e.querySelectorAll("a[href]"),n=window.location.host;t.forEach(o=>{let i=o.getAttribute("href");if(i&&!(i.startsWith("#")||i.startsWith("/")||i.startsWith("../")||i.startsWith("mailto:")||i.startsWith("tel:")))try{new URL(i,window.location.origin).host!==n&&(o.setAttribute("target","_blank"),o.setAttribute("rel","noopener noreferrer"))}catch{}})}function Ge(e,t){e.forEach(n=>{if(n.isIntersecting){let o=n.target;o.classList.add("fade-in"),t.unobserve(o)}})}var Je=new IntersectionObserver(Ge,{root:null,rootMargin:"0px",threshold:.1});function pe(e){e.forEach(t=>{!t.classList.contains("fade-in")&&!t.classList.contains("no-fade")&&Je.observe(t)})}function Xe(){let e=document.querySelectorAll(".project-item");pe(e)}function Ze(e,t){e.forEach(n=>{if(n.isIntersecting){let o=n.target,i=o.getAttribute("data-bg");if(i){let r=new Image;r.onload=()=>{o.style.backgroundImage=`url('${i}')`,o.removeAttribute("data-bg"),requestAnimationFrame(()=>{o.classList.remove("lazy-thumbnail")})},r.src=i}t.unobserve(o)}})}var Qe=new IntersectionObserver(Ze,{rootMargin:"0px 0px 50px 0px",threshold:.1});function C(e=document){e.querySelectorAll(".lazy-thumbnail").forEach(n=>{n.getAttribute("data-bg")&&Qe.observe(n)})}var et=768,tt=.0015,nt=document.body.dataset.debugHls==="true";function u(...e){nt&&console.log(...e)}function he(e){return e.closest(".video-container")}function H(e){if(e==null||e==="")return null;let t=typeof e=="number"?e:Number.parseFloat(e);return Number.isFinite(t)&&t>0?t:null}function ge(e){let t=H(e.dataset.videoWidth),n=H(e.dataset.videoHeight);if(t&&n)return t/n;let o=e.videoWidth,i=e.videoHeight;return o>0&&i>0?o/i:null}function be(e){let t=he(e);if(!t)return;let n=ge(e);n&&t.style.setProperty("--video-aspect-ratio",n.toString())}function ot(e){e.videoLayoutCleanup&&e.videoLayoutCleanup();let t=()=>be(e);e.addEventListener("loadedmetadata",t),e.addEventListener("resize",t),t(),e.videoLayoutCleanup=()=>{e.removeEventListener("loadedmetadata",t),e.removeEventListener("resize",t)}}function it(e,t){let n=ge(t),i=he(t)?.getBoundingClientRect()?.height??t.clientHeight??0;if(i<=0)return null;let r=e.levels.map((l,d)=>{let m=H(l.height);if(!m)return null;let h=H(l.width),$e=n&&h?Math.abs(h/m-n):0;return{index:d,width:h,height:m,bitrate:H(l.bitrate)??0,aspectDrift:$e}}).filter(l=>l!==null);if(!r.length)return null;let s=r;if(n){let l=r.filter(d=>d.width!==null&&d.aspectDrift<=tt);l.length&&(s=l)}let c=[...s].sort((l,d)=>l.height!==d.height?l.height-d.height:d.bitrate-l.bitrate),a=c.find(l=>l.height>=i*.95);return a?a.index:c[c.length-1]?.index??null}function rt(e,t){let n=it(e,t);if(n===null)return;let o=e.levels[n];u("[HLS] Stable start level selected",{level:n,resolution:o?`${o.width??"?"}x${o.height}`:"unknown",bitrate:o?.bitrate}),e.startLevel=n,window.innerWidth<=et&&(e.loadLevel=n,e.nextLevel=n,e.currentLevel=n)}function Le(){return N()}function w(e,t=!1){return u("[HLS] setupHLSPlayer called",{autoplay:t}),e.dataset.loaded="true",new Promise((n,o)=>{let i=e.dataset.hlsUrl;if(u("[HLS] Stream URL:",i),!i){console.error("No HLS URL provided for video element"),o("No HLS URL provided");return}e.classList.add("hls-video"),ot(e);let r=()=>{if(be(e),document.body.classList.contains("editing")){e.pause(),n();return}t&&e.paused&&e.play().catch(a=>{a.name!=="AbortError"&&console.error("Autoplay failed:",a)}),n()},s=ne(e);u("[HLS] Native HLS support:",s?"yes":"no"),u("[HLS] HLS.js loaded:",!!window.Hls),u("[HLS] HLS.js supported:",window.Hls?Hls.isSupported():"n/a");let c=()=>{if(!window.Hls||!Hls.isSupported()){if(s){e.src=i,t&&!document.body.classList.contains("editing")&&e.play().catch(()=>{}),e.addEventListener("loadedmetadata",r,{once:!0});return}console.error("HLS is not supported in this browser"),o("HLS is not supported");return}e.hlsInstance&&(console.warn("HLS instance already exists for this video element. Destroying existing instance."),F(e));let a=new Hls(te);e.hlsInstance=a,a.loadSource(i),a.attachMedia(e),a.on(Hls.Events.MEDIA_ATTACHED,()=>{a.on(Hls.Events.MANIFEST_PARSED,()=>{rt(a,e),u("[HLS] Available quality levels:"),a.levels.forEach((l,d)=>{u(`  [${d}] ${l.width??"?"}x${l.height} @ ${(l.bitrate/1e6).toFixed(1)} Mbps`)}),u(`[HLS] Starting level: ${a.startLevel} (auto: ${a.autoLevelEnabled})`),u(`[HLS] Current level: ${a.currentLevel}, Next level: ${a.nextLevel}`),r()})}),a.on(Hls.Events.LEVEL_SWITCHED,(l,d)=>{let m=d,h=a.levels[m.level];h&&u(`[HLS] Switched to level ${m.level}: ${h.height}p @ ${(h.bitrate/1e6).toFixed(1)} Mbps`)}),a.on(Hls.Events.ERROR,(l,d)=>{let m=d;if(m.fatal)switch(m.type){case Hls.ErrorTypes.NETWORK_ERROR:console.error("Fatal network error encountered, trying to recover"),a.startLoad();break;case Hls.ErrorTypes.MEDIA_ERROR:console.error("Fatal media error encountered, trying to recover"),a.recoverMediaError();break;default:console.error("Fatal error encountered, destroying HLS instance:",d),a.destroy(),e.hlsInstance=null,o(d);break}else m.details==="bufferAppendError"?(console.warn("HLS.js bufferAppendError encountered and ignored:",d),a.recoverMediaError()):console.warn("HLS.js non-fatal error:",d)})};if(window.Hls&&Hls.isSupported()){u("[HLS] Using HLS.js (already loaded)"),c();return}u("[HLS] Loading HLS.js script..."),N().then(()=>{Hls.isSupported()?(u("[HLS] HLS.js loaded and supported, using HLS.js"),c()):s?(u("[HLS] HLS.js not supported, falling back to native"),e.src=i,t&&!document.body.classList.contains("editing")&&e.play().catch(()=>{}),e.addEventListener("loadedmetadata",r,{once:!0})):(console.error("HLS is not supported in this browser"),o("HLS is not supported"))}).catch(a=>{if(s){u("[HLS] HLS.js failed to load, falling back to native"),e.src=i,t&&!document.body.classList.contains("editing")&&e.play().catch(()=>{}),e.addEventListener("loadedmetadata",r,{once:!0});return}console.error("Failed to load HLS.js:",a),o(a)})})}function g(e){if(e.videoLayoutCleanup&&(e.videoLayoutCleanup(),e.videoLayoutCleanup=null),F(e),delete e.dataset.loaded,e.src&&e.src.startsWith("blob:")){let t=e.src;URL.revokeObjectURL(t),e.src=""}}async function W(e,t=!0){try{let n=e.querySelector("video.lazy-video"),o=e.querySelector(".thumbnail");if(e.classList.contains("active")){n&&await w(n,!0);let i=e.querySelector(".project-header");i&&t&&fe(i)}else n&&(n.pause(),g(n)),o&&k(o);typeof b=="function"&&b()}catch(n){console.error("Error in handleProjectContent:",n)}}function st(){document.querySelectorAll(".project-item.active").forEach(t=>{t.classList.remove("active");let n=t.querySelector("video.lazy-video");n&&(n.pause(),g(n));let o=t.querySelector(".project-details");o&&(o.innerHTML="");let i=t.querySelector(".thumbnail");i&&k(i)})}var v=0;function b(){let e=document.querySelectorAll(".thumbnail");e.length&&e.forEach(t=>{let n=parseInt(t.dataset.frames??"0",10),o=parseInt(t.dataset.frameWidth??"0",10),i=parseInt(t.dataset.frameHeight??"0",10),r=parseInt(t.dataset.columns??"1",10),s=Math.ceil(n/r),c=o*r,a=i*s;t.style.backgroundSize=`${c}px ${a}px`;let l=Math.floor(v)%n;l<0&&(l+=n);let d=l%r*o,m=Math.floor(l/r)*i;t.style.backgroundPosition=`-${d}px -${m}px`})}var de=window.pageYOffset||document.documentElement.scrollTop,ue=Date.now(),f=0,K=Date.now(),y=null;function ve(){y!==null||document.hidden||(K=Date.now(),y=requestAnimationFrame(ye))}function Y(){y!==null&&(cancelAnimationFrame(y),y=null)}function at(){let e=window.pageYOffset||document.documentElement.scrollTop,t=Date.now(),n=(t-ue)/1e3;n>0&&(f=(e-de)/n/3,f=Math.max(-30,Math.min(30,f))),de=e,ue=t,Math.abs(f)>.01&&ve()}function ye(){if(document.hidden){Y();return}let e=Date.now(),t=(e-K)/1e3;K=e;let n=15,o=Math.abs(f)*.1,i=n+o;f>0?f=Math.max(0,f-i*t):f<0&&(f=Math.min(0,f+i*t)),v+=f*t,v>1e6&&(v-=1e6),v<-1e6&&(v+=1e6),b(),Math.abs(f)>.01?y=requestAnimationFrame(ye):(f=0,Y())}function lt(){window.location.pathname==="/"||document.querySelectorAll(".project-item").forEach(n=>{n.classList.add("no-fade")}),C(),b(),window.addEventListener("scroll",at)}function Ee(e=document){let t=e.querySelectorAll("video.lazy-video");if("IntersectionObserver"in window){let n=new IntersectionObserver((o,i)=>{o.forEach(r=>{if(r.isIntersecting){let s=r.target;if(s.dataset.loaded==="true"){i.unobserve(s);return}w(s,!1).catch(c=>{console.error("Failed to initialize HLS player for video:",c)}),i.unobserve(s),s.dataset.loaded="true"}})},{rootMargin:"0px 0px 200px 0px",threshold:.25});t.forEach(o=>{o.dataset.loaded||n.observe(o)})}else t.forEach(n=>{w(n,!1).catch(o=>{console.error("Failed to initialize HLS player for video:",o)}),n.dataset.loaded="true"})}var j=null;function Se(e){if(e.dataset.loaded==="true")return;let t=!1,n=e.dataset.src;if(n&&(e.src=n,e.removeAttribute("data-src"),t=!0),e.querySelectorAll("source[data-src]").forEach(i=>{let r=i.dataset.src;r&&(i.src=r,i.removeAttribute("data-src"),t=!0)}),!t){e.dataset.loaded="true";return}e.dataset.loaded="true",e.load(),(e.autoplay||e.hasAttribute("autoplay"))&&e.play().catch(()=>{})}function ct(){return"IntersectionObserver"in window?j||(j=new IntersectionObserver((e,t)=>{e.forEach(n=>{if(!n.isIntersecting)return;let o=n.target;t.unobserve(o),Se(o)})},{rootMargin:"0px 0px 250px 0px",threshold:.01}),j):null}function He(e=document){let t=e.querySelectorAll("video.lazy-inline-video"),n=ct();t.forEach(o=>{o.dataset.loaded!=="true"&&(n?n.observe(o):Se(o))})}function dt(){Ee(),He(),C(),B(),ut()}function ut(){let e=document.querySelector(".project-item.active");e&&(document.readyState==="complete"?W(e,!1):window.addEventListener("load",()=>{W(e,!1)}))}function G(){document.querySelectorAll("video.hls-video").forEach(n=>{g(n)}),document.querySelectorAll("video").forEach(n=>{n.hlsInstance&&g(n)})}function ft(){G()}function mt(e){let{element:t,isOpen:n,smoothScroll:o=!0}=e.detail;if(!t)return;let i=t.closest(".project-item");if(i){if(n){let r=t.querySelector("video.lazy-video");r&&w(r,!0).catch(c=>{console.error("Failed to initialize HLS player:",c)});let s=i.querySelector(".project-header");s&&o&&fe(s)}else{let r=i.querySelector("video.lazy-video");r&&(r.pause(),g(r));let s=i.querySelector(".thumbnail");s&&k(s)}C(t),Ee(t),He(t),B(t),b(),me(t)}}function pt(){let e=document.querySelectorAll(".project-item:not(.fade-in):not(.no-fade)");pe(e),C(),b()}function ht(){let e=new URL("/",window.location.origin);return(new URLSearchParams(window.location.search).get("show_drafts")==="true"||sessionStorage.getItem("bb_show_drafts")==="true")&&e.searchParams.set("show_drafts","true"),e}function we(){window.location.href=ht().toString()}function U(e){let t=e.closest(".project-item");if(!t)return;if(document.body.dataset.isolationMode==="true"){if(t.dataset.closing==="true")return;t.dataset.closing="true",t.classList.add("fade-out"),t.addEventListener("animationend",function(i){i.target!==t||i.animationName!=="fadeOut"||we()},{once:!0})}else{t.classList.remove("active");let o=t.querySelector("video.lazy-video");o&&(o.pause(),g(o));let i=t.querySelector(".thumbnail");i&&k(i);let r=t.querySelector(".project-details");r&&(r.innerHTML="")}}function gt(){document.body.addEventListener("project:afterSwap",mt),document.body.addEventListener("project:beforeSwap",ft),document.body.addEventListener("projects:loaded",pt),document.body.addEventListener("project:error",()=>{L("Failed to load content. Please try again.",!0)}),document.body.addEventListener("click",e=>{let n=e.target.closest(".copy-text-link");if(n){e.preventDefault();let o=n.getAttribute("data-copy-text"),i=n.getAttribute("data-notification-message")||"URL copied to clipboard!";o?V(o,i):(console.warn("No copy text provided for copying."),L("No content available to copy.",!0))}}),document.body.addEventListener("click",function(e){let t=e.target.closest(".close-project");t&&document.body.dataset.isolationMode==="true"&&(e.preventDefault(),U(t))}),document.body.addEventListener("click",function(e){let t=e.target.closest("a.site-title");if(!t||e.defaultPrevented||e.button!==0||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||t.target&&t.target!=="_self")return;let n;try{n=new URL(t.href,window.location.origin)}catch{return}if(n.origin!==window.location.origin||n.pathname!=="/")return;if(!(document.body.dataset.isolationMode==="true")){if(window.location.pathname==="/me")try{let s=document.referrer?new URL(document.referrer):null;if(!!s&&s.origin===window.location.origin&&s.pathname==="/"){e.preventDefault(),window.history.back();return}}catch{}return}e.preventDefault();let r=document.querySelector(".project-item.active")?.querySelector(".close-project");if(r){U(r);return}we()}),document.body.addEventListener("click",function(e){let t=e.target,n=t.closest(".project-content img");if(n){e.preventDefault(),le(n);return}let o=t.closest(".project-content video");!o||!z(o)||(e.preventDefault(),ce(o))}),document.body.addEventListener("click",function(e){let t=e.target.closest('.project-content a[href^="#"]');if(!t||e.defaultPrevented||e.button!==0||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey)return;let n=t.getAttribute("href")||"",o=$(n);if(!o)return;e.preventDefault();let i=new URL(window.location.href);i.hash=o.id,history.pushState(history.state,"",i.toString()),o.scrollIntoView({behavior:"smooth",block:"start"}),requestAnimationFrame(()=>{o.scrollIntoView({behavior:"auto",block:"start"})}),setTimeout(()=>{o.scrollIntoView({behavior:"auto",block:"start"})},180)}),document.addEventListener("keydown",function(e){if(e.key==="Escape"){if(document.body.classList.contains("editing")||P())return;let t=document.querySelector(".project-item.active");if(t){let n=t.querySelector(".close-project");if(n)if(document.body.dataset.isolationMode==="true")U(n);else{let i=t.dataset.slug;i&&O(i)}}}}),document.addEventListener("visibilitychange",()=>{document.hidden?Y():Math.abs(f)>.01&&ve()})}function bt(){lt(),dt(),Xe(),me(),window.addEventListener("beforeunload",G)}function Lt(){bt(),gt(),window.addEventListener("load",()=>oe("auto"))}var vt={init:Lt,handleProjectContent:W,closeAllOpenProjects:st,cleanupActiveHLSPlayers:G,copyToClipboard:V,updateThumbnails:b,setupHLSPlayer:w,destroyHLSPlayer:g},Te=vt;var T=null;function Ae(e){e.querySelector("pre code")&&ee(e)}function yt(){let e=new URLSearchParams(window.location.search);return e.has("show_drafts")?e.get("show_drafts")==="true":sessionStorage.getItem("bb_show_drafts")==="true"}function R(e,t={}){let n=new URL(e,window.location.origin);return Object.entries(t).forEach(([o,i])=>{i!=null&&n.searchParams.set(o,String(i))}),yt()&&n.searchParams.set("show_drafts","true"),n.toString()}function x(){return document.body.dataset.projectUrlSync!=="false"}function p(e,t={}){document.body.dispatchEvent(new CustomEvent(e,{bubbles:!0,detail:t}))}function Ie(e,t=!1){let n=document.createElement("div");n.className=`copy-notification${t?" error":""}`,n.textContent=e,document.body.appendChild(n),setTimeout(()=>{n.parentNode&&document.body.removeChild(n)},4e3)}async function Pe(e,t){let n=new URL(e,window.location.origin);n.searchParams.set("_partial","1");let o=await fetch(n.toString(),{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"text/html"},signal:t});if(!o.ok)throw new Error(`HTTP ${o.status}: ${o.statusText}`);return await o.text()}async function D(e,t={}){let n=x(),{pushUrl:o=n,smoothScroll:i=!0}=t,r=document.querySelector(`.project-item[data-slug="${e}"]`);if(!r){console.error(`Project item not found for slug: ${e}`);return}if(r.classList.contains("active"))return;let s=document.getElementById(`details-${e}`);if(!s){console.error(`Details container not found for slug: ${e}`);return}T&&T.abort(),T=new AbortController,J(),p("project:beforeLoad",{element:s,slug:e,isOpen:!0});try{let c=R(`/${e}`),a=await Pe(c,T.signal);if(p("project:beforeSwap",{element:s,slug:e,isOpen:!0}),s.innerHTML=a,r.classList.add("active"),o){let l=R(`/${e}`);history.pushState({slug:e,isOpen:!0},"",l)}p("project:afterSwap",{element:s,slug:e,isOpen:!0,smoothScroll:i}),Ae(s)}catch(c){if(c instanceof Error&&c.name==="AbortError")return;console.error("Failed to load project:",c),p("project:error",{element:s,slug:e,isOpen:!1,error:c instanceof Error?c:new Error(String(c))}),Ie("Failed to load content. Please try again.",!0)}finally{T=null}}async function O(e,t={}){let n=x(),{pushUrl:o=n}=t,i=document.querySelector(`.project-item[data-slug="${e}"]`);if(!i)return;let r=document.getElementById(`details-${e}`);if(r){if(p("project:beforeSwap",{element:r,slug:e,isOpen:!1}),r.innerHTML="",i.classList.remove("active"),o){let s=R("/");history.pushState({slug:null,isOpen:!1},"",s)}p("project:afterSwap",{element:r,slug:e,isOpen:!1})}}function J(){document.querySelectorAll(".project-item.active").forEach(t=>{let n=t.dataset.slug;if(!n)return;let o=document.getElementById(`details-${n}`);p("project:beforeSwap",{element:o,slug:n,isOpen:!1}),o&&(o.innerHTML=""),t.classList.remove("active"),p("project:afterSwap",{element:o,slug:n,isOpen:!1})})}async function je(e){let t=parseInt(e.dataset.page??"",10);if(!(!t||e.dataset.loading==="true")){e.dataset.loading="true";try{let n=R("/",{page:t}),o=await Pe(n);e.insertAdjacentHTML("beforebegin",o),e.remove(),p("projects:loaded",{page:t})}catch(n){console.error("Failed to load more projects:",n),e.dataset.loading="false",Ie("Failed to load more projects.",!0)}}}var M=null;function Et(){M&&M.disconnect(),M=new IntersectionObserver(e=>{e.forEach(t=>{if(t.isIntersecting){let n=t.target;n.dataset.page&&je(n)}})},{rootMargin:"100px",threshold:0}),ke()}function ke(){document.querySelectorAll('[id^="infinite-scroll-sentinel-"]').forEach(t=>{t.dataset.page&&M&&M.observe(t)})}function St(e){if(!x())return;let t=e.state;if(t&&t.slug&&t.isOpen)D(t.slug,{pushUrl:!1});else{let n=window.location.pathname;n==="/"?J():n!=="/me"&&window.location.reload()}}function Ht(e){let t=e.target,n=t.closest(".project-header");if(n){let r=n.closest(".project-item");if(r){let s=r.dataset.slug;if(s){e.preventDefault(),D(s);return}}}let o=t.closest(".thumbnail");if(o){let r=o.closest(".project-item");if(r){let s=r.dataset.slug;if(s){e.preventDefault(),D(s);return}}}let i=t.closest(".close-project");if(i&&!(document.body.dataset.isolationMode==="true")){let s=i.closest(".project-item");if(s){let c=s.dataset.slug;if(c){e.preventDefault(),O(c);return}}}}function Me(e){let t=e.target,n=t.closest(".project-header"),o=t.closest(".thumbnail");(n||o)&&Le()}function xe(){if(document.body.addEventListener("click",Ht),document.body.addEventListener("mousedown",Me),document.body.addEventListener("touchstart",Me,{passive:!0}),x()&&window.addEventListener("popstate",St),Et(),document.body.addEventListener("projects:loaded",()=>{ke()}),x()&&!history.state){let e=window.location.pathname;if(e!=="/"&&e!=="/me"){let t=e.slice(1);!!document.querySelector(`.project-item[data-slug="${t}"]`)?history.replaceState({slug:t,isOpen:!0},""):history.replaceState({slug:null,isOpen:!1},"")}else history.replaceState({slug:null,isOpen:!1},"")}Ae(document.body)}function wt(){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",xe):xe()}var Tt={openProject:D,closeProject:O,closeAllProjects:J,loadMoreProjects:je,dispatchEvent:p,init:wt},Ce=Tt;var Mt=/^\s*([0-9]*\.?[0-9]+)\s*px(?:\s*!important)?\s*$/i,X=new WeakMap,Oe=!1;function xt(e){return e.dataset.autoHeight!=="false"}function At(){Oe||(Oe=!0,window.addEventListener("message",e=>{if(!e.source||typeof e.data!="object"||e.data?.type!=="sandbox-resize")return;let t=X.get(e.source);t&&e.data.nonce===t.nonce&&xt(t.iframe)&&(t.iframe.style.height=`${e.data.height}px`)}))}function It(){return crypto.randomUUID()}function Re(e,t){let n=new RegExp(`(?:^|;)\\s*${t}\\s*:\\s*([^;]+)`,"i"),o=e.match(n);if(!o)return null;let i=o[1]?.match(Mt);if(!i)return null;let r=Number.parseFloat(i[1]??"");return!Number.isFinite(r)||r<=0?null:r}function Pt(e){let t=/(?:^|;)\s*margin-left\s*:\s*auto(?:\s*!important)?\s*(?:;|$)/i.test(e),n=/(?:^|;)\s*margin-right\s*:\s*auto(?:\s*!important)?\s*(?:;|$)/i.test(e);return t&&n?"center":t?"right":null}function jt(e,t){if(e.style.marginLeft="",e.style.marginRight="",t==="center"){e.style.marginLeft="auto",e.style.marginRight="auto";return}t==="right"&&(e.style.marginLeft="auto",e.style.marginRight="0")}function De(e,t,n){t&&(e.style.cssText+=`; ${t}`);let o=n??(t?Pt(t):null)??"left";if(jt(e,o),!t)return;let i=Re(t,"width"),r=Re(t,"height");!i||!r||(e.style.width=`${i}px`,e.style.height="auto",e.style.aspectRatio=`${i} / ${r}`,e.style.maxWidth="100%")}function kt(e,t){return`<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    * { box-sizing: border-box; }
    body { margin: 0; font-family: system-ui, -apple-system, sans-serif; }
  </style>
</head>
<body>
${e}
<script>
(function() {
  var nonce = "${t}";
  function reportHeight() {
    var height = Math.max(
      document.body.scrollHeight,
      document.documentElement.scrollHeight
    );
    window.parent.postMessage({ type: 'sandbox-resize', nonce: nonce, height: height }, '*');
  }
  new ResizeObserver(reportHeight).observe(document.body);
  window.addEventListener('load', reportHeight);
  reportHeight();
})();
<\/script>
</body>
</html>`}function Ne(e,t={}){At();let n=document.createElement("iframe");n.className="html-block-sandbox";let o=["allow-scripts"];t.allowFullscreen!==!1&&n.setAttribute("allow","fullscreen"),t.allowPointerLock&&o.push("allow-pointer-lock"),n.setAttribute("sandbox",o.join(" "));let i=It();return n.srcdoc=kt(e,i),n.style.minHeight=`${t.minHeight??60}px`,n.dataset.autoHeight="true",n.addEventListener("load",()=>{n.contentWindow&&X.set(n.contentWindow,{iframe:n,nonce:i})}),n}function Fe(e){e.contentWindow&&X.delete(e.contentWindow)}var E=null;function Ct(e){let n=e.trim().match(/^<div\b[^>]*\bstyle\s*=\s*["'][^"']*\btext-align\s*:\s*(center|right)\b[^"']*["'][^>]*>[\s\S]*<\/div>$/i);if(n)return n[1]}function Ve(e){let t=e.getAttribute("data-html-b64");if(t)try{let n=atob(t),o=Ne(n,{allowFullscreen:!0}),i=e.getAttribute("style"),r=!!i&&/(^|;)\s*height\s*:/.test(i);o.dataset.autoHeight=r?"false":"true",De(o,i,Ct(n)),e.replaceWith(o)}catch(n){console.error("Failed to decode HTML block:",n)}}function Ot(){return"IntersectionObserver"in window?E||(E=new IntersectionObserver((e,t)=>{e.forEach(n=>{n.isIntersecting&&(t.unobserve(n.target),Ve(n.target))})},{rootMargin:"0px 0px 250px 0px",threshold:.01}),E):null}function Z(e=document){let t=e.querySelectorAll(".html-block-sandbox[data-html-b64]"),n=Ot();t.forEach(o=>{if(n){n.observe(o);return}Ve(o)})}function Rt(e=document){E&&e.querySelectorAll(".html-block-sandbox[data-html-b64]").forEach(t=>{E?.unobserve(t)}),e.querySelectorAll("iframe.html-block-sandbox").forEach(t=>{t instanceof HTMLIFrameElement&&Fe(t)})}function Dt(){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>Z()):Z(),document.body.addEventListener("project:afterSwap",e=>{let n=e.detail?.element||document;Z(n)}),document.body.addEventListener("project:beforeSwap",e=>{let n=e.detail?.element||document;Rt(n)})}Te.init();Ce.init();Dt();})();
//# sourceMappingURL=project-bundle.js.map
